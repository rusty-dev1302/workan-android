<!-- Filter Modal -->
<div class="modal fade" id="addFilterModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="addFilterModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addFilterModalLabel">Filters</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <section class="container">
          <div class="row">

            <div class="form-section" style="padding: 0!important;">

              <!-- User Form Starts -->
              <form #editListing="ngForm">

                <div class="mb-1">
                  <div class="row g-3">

                    <div class="col-12">
                      <div class="form-group">
                        <label for="subcategory"><i class="fa fa-star px-1" aria-hidden="true" style="color: rgb(69, 69, 69);"></i>Specialization</label>
                      </div>
                      <select #subcategory class="form-select" aria-label="subcategory" [value]="currentSubcategory"
                        (change)="selectSubcategory(subcategory.value)">
                        <option default hidden>{{currentSubcategory}}</option>
                        <option *ngFor="let subCategory of subCategories" [value]="subCategory">
                          {{subCategory}}</option>
                      </select>
                    </div>

                    <div class="col-12">
                      <div class="form-group">
                        <label for="sortBy"><i class="fa fa-sort px-2" aria-hidden="true"></i>Sort by
                        </label>
                      </div>
                      <select #sortBy class="form-select" aria-label="sortBy" [value]="sortByValue"
                        (change)="selectSortBy(sortBy.value)">
                        <option default hidden>{{sortByValue}}</option>
                        <option *ngFor="let sortElement of sortByArray" [value]="sortElement">
                          {{sortElement}}</option>
                      </select>
                    </div>

                    <div class="col-12">
                      <div class="form-group">
                        <app-select-map-location headline="Location" [initialValue]="currentLocation" [isFilter]="true"
                          (outputEvent)="locationSelectorOutput($event)" (averageDistanceEvent)="setAverageDistance($event)" [distance]="distanceInKm"></app-select-map-location>
                      </div>
                    </div>

                    <div class="col-12 text-end">
                      <h5 style="font-size: 1rem!important;"><a class="link" data-bs-dismiss="modal" type="button"
                          (click)="clearAllFilters()">Clear all</a></h5>
                    </div>

                  </div>
                </div>

                <!-- Edit buttons -->
                <div class="mt-2" style="padding-top: .4rem;">
                  <div class="row">
                    <div class="modal-footer">
                      <button type="submit" class="btn btn-danger btn-rounded col-12" data-bs-toggle="modal"
                        data-bs-target="#addFilterModal" data-bs-dismiss="modal"
                        (click)="saveFilters()">Save</button>
                    </div>
                  </div>
                </div>

              </form>
              <!-- User Form Ends -->
            </div>

          </div>
        </section>

      </div>
    </div>
  </div>
</div>
<!-- Filter Modal Ends -->

<!--Divider section-->
<section class="bg-color py-2">
  <section class="container">
    <div class="row">

      <div
        class="d-flex flex-column align-items-start justify-content-end col-xl-8 xol-lg-8 col-md-12 col-12 order-1 order-lg-0 text-md-start text-center">
        <h1 class=" text-capitalize fw-bolder text-white">
          Listings
        </h1>
      </div>

    </div>
  </section>
</section>

<!--Divider section end -->


<div class="content-box">

  <!-- navigation bar starts -->
  <nav class="nav navbar nav-underline justify-content-end align-items-start navbar-dark"
    style="background-color: #222;">

    <li class="nav-item">
      <a type="button" (click)="getListingSubcategories()" data-bs-toggle="modal" data-bs-target="#addFilterModal"
        style="margin-right: 1rem!important;color: white;">
        <i *ngIf="currentSubcategory!=''||geoHash!=''||sortByValue!=''" class="fa fa-circle" aria-hidden="true"
          style="font-size: .5rem!important;color: red;position: absolute;top: .7rem;right: .7rem;"></i>
        <svg xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF" width="18" height="18" viewBox="0 0 20 20"
          aria-labelledby="icon-svg-title- icon-svg-desc-" role="img" class="sc-rbbb40-0 iwHbVQ">
          <title>Filters</title>
          <path
            d="M2.14 6.42h7.26c0.353 1.207 1.45 2.074 2.75 2.074s2.397-0.867 2.745-2.054l0.005-0.020h2.96c0.343-0.059 0.6-0.355 0.6-0.71s-0.258-0.651-0.596-0.709l-0.004-0.001h-2.94c-0.341-1.226-1.447-2.11-2.76-2.11s-2.419 0.885-2.755 2.090l-0.005 0.020h-7.26c-0.343 0.059-0.6 0.355-0.6 0.71s0.257 0.651 0.596 0.709l0.004 0.001zM12.16 4.28c0.776 0.011 1.4 0.643 1.4 1.42 0 0.784-0.636 1.42-1.42 1.42-0.777 0-1.409-0.624-1.42-1.399l-0-0.001c-0-0.006-0-0.013-0-0.020 0-0.784 0.636-1.42 1.42-1.42 0.007 0 0.014 0 0.021 0l-0.001-0zM17.86 13.58h-7.24c-0.328-1.245-1.443-2.148-2.77-2.148s-2.442 0.903-2.766 2.128l-0.004 0.020h-2.94c-0.036-0.006-0.077-0.010-0.12-0.010-0.398 0-0.72 0.322-0.72 0.72s0.322 0.72 0.72 0.72c0.042 0 0.084-0.004 0.124-0.011l-0.004 0.001h2.96c0.353 1.207 1.45 2.074 2.75 2.074s2.397-0.867 2.745-2.054l0.005-0.020h7.26c0.343-0.059 0.6-0.355 0.6-0.71s-0.258-0.651-0.596-0.709l-0.004-0.001zM7.84 15.72c-0.776-0.011-1.4-0.643-1.4-1.42 0-0.784 0.636-1.42 1.42-1.42 0.777 0 1.409 0.624 1.42 1.399l0 0.001c0 0.006 0 0.013 0 0.020 0 0.784-0.636 1.42-1.42 1.42-0.007 0-0.014-0-0.021-0l0.001 0z">
          </path>
        </svg> Filters
      </a>
    </li>

  </nav>
  <!-- navigation bar ends -->
  <section *ngIf="listings?.length != 0" class="common-section blog-section">

    <div class="container" infiniteScroll [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50"
      (scrolled)="onScroll()">

      <div class="row g-3 mt-4" style="margin-left: 0!important;margin-right: 0!important;">
        <div class="col-xl-4 col-md-6 col-12" *ngFor="let listing of listings">
          <div class="d-flex justify-content-center align-items-center">
            <div class="card list-card py-3" style="width: 25rem;padding-bottom: 0!important;">
              <img *ngIf="!listing.professional.profilePhoto" alt="..." class="card-img-top" src="assets/profile.png">
              <img *ngIf="listing.professional.profilePhoto" alt="..." class="card-img-top"
                [src]="'data:image/png;base64,'+listing.professional.profilePhoto.thumbnail">
              <div class="card-body">
                <h4 class="card-title text-center">{{listing.professional.firstName}} {{listing.professional.lastName}}
                </h4>
                <div class="col-12" style="margin-bottom: 1rem!important;">
                  <a class="btn border btn-small btn-danger btn-rounded col-12"
                    [routerLink]="['/listingDetail',listing.id]" type="button">
                    View</a>
                </div>
                <h6 *ngIf="listing" style="padding-left: .26rem!important;"><b><i class="fa-solid fa-dollar-sign" style="color: green;"></i>{{listing.minCharge |
                    number : '1.2-2'}} - <i class="fa-solid fa-dollar-sign" style="color: green;"></i>{{listing.maxCharge |
                    number : '1.2-2'}}</b></h6>

                <h6><i class="fa fa-star rating-color"></i> {{listing.professional.rating | number : '1.1-1'}}</h6>
                <span>
                  <h6>
                    <div class="svg-container">
                      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                        width="50" height="50" viewBox="0 0 256 256" xml:space="preserve" style="margin-right: 2px;">
                        <defs>
                        </defs>
                        <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;"
                          transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
                          <path
                            d="M 44.759 63.847 L 56.954 90 l 9.909 -9.079 l 13.325 -1.755 L 68.323 53.721 c -9.609 -0.082 -17.439 3.046 -23.082 10.126"
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(237,99,98); fill-rule: nonzero; opacity: 1;"
                            transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                          <path
                            d="M 45.241 63.847 L 33.046 90 l -9.909 -9.079 L 9.812 79.166 l 11.865 -25.445 C 33.52 52.826 41.539 56.026 45.241 63.847 z"
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(233,84,84); fill-rule: nonzero; opacity: 1;"
                            transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                          <path
                            d="M 45 63.847 c 17.631 0 31.923 -14.293 31.923 -31.923 S 62.631 0 45 0 C 34.483 21.782 33.645 43.104 45 63.847 z"
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(255,204,91); fill-rule: nonzero; opacity: 1;"
                            transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                          <path d="M 45 63.847 c -17.631 0 -31.923 -14.293 -31.923 -31.923 S 27.369 0 45 0 v 63.814"
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(253,188,75); fill-rule: nonzero; opacity: 1;"
                            transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                          <path
                            d="M 38.778 54.411 c -0.092 0 -0.186 -0.013 -0.279 -0.039 C 26.122 50.786 18.967 37.8 22.552 25.422 c 0.153 -0.531 0.707 -0.836 1.239 -0.682 c 0.53 0.153 0.836 0.708 0.682 1.239 c -3.277 11.318 3.264 23.193 14.583 26.471 c 0.53 0.154 0.836 0.709 0.682 1.239 C 39.611 54.127 39.211 54.411 38.778 54.411 z"
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(236,153,34); fill-rule: nonzero; opacity: 1;"
                            transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                          <path
                            d="M 66.487 39.146 c -0.092 0 -0.186 -0.013 -0.278 -0.04 c -0.53 -0.154 -0.836 -0.708 -0.683 -1.239 c 1.589 -5.483 0.946 -11.256 -1.808 -16.256 c -2.755 -5 -7.291 -8.628 -12.774 -10.216 c -0.53 -0.153 -0.836 -0.708 -0.683 -1.239 c 0.154 -0.53 0.708 -0.835 1.239 -0.682 c 5.996 1.736 10.957 5.704 13.969 11.172 c 3.013 5.468 3.715 11.781 1.979 17.777 C 67.321 38.862 66.922 39.146 66.487 39.146 z"
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(236,153,34); fill-rule: nonzero; opacity: 1;"
                            transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                          <path
                            d="M 53.093 44.529 c -0.159 0 -0.319 -0.038 -0.465 -0.115 L 45 40.405 l -7.627 4.01 c -0.337 0.177 -0.744 0.147 -1.053 -0.076 c -0.308 -0.224 -0.462 -0.603 -0.398 -0.978 l 1.457 -8.493 l -6.17 -6.015 c -0.272 -0.266 -0.371 -0.664 -0.253 -1.025 s 0.431 -0.626 0.808 -0.681 l 8.527 -1.239 l 3.813 -7.727 c 0.168 -0.341 0.516 -0.558 0.897 -0.558 l 0 0 c 0.381 0 0.729 0.216 0.897 0.558 l 3.813 7.727 l 8.527 1.239 c 0.377 0.055 0.689 0.319 0.808 0.681 c 0.117 0.362 0.02 0.759 -0.253 1.025 l -6.171 6.015 l 1.457 8.493 c 0.064 0.375 -0.09 0.754 -0.397 0.978 C 53.507 44.465 53.3 44.529 53.093 44.529 z"
                            style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(236,153,34); fill-rule: nonzero; opacity: 1;"
                            transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />
                        </g>
                      </svg>
                      <span *ngIf="(listing.professional.certifications|certificate).length<=0"
                        style="font-size: .9rem;color: rgb(113, 113, 113);"> N/A</span>
                      <span *ngFor="let cert of listing.professional.certifications|certificate; let i=index" style="font-size: .89rem;font-weight: bold;"><a *ngIf="i!=0" style="margin-right: 1px;color: rgb(191, 191, 191);">|</a>{{cert.name}}</span>
                    </div>
                  </h6>
                </span>
                <hr class="style1">
                <p class="card-text mt-2 mb-3">
                <div style="min-height: 6rem;">
                  <h6><b>Spec:</b><span> {{listing.subCategory.subCategoryName}}</span></h6>
                  <h6><b>Exp:</b><span> {{listing.experience>5?'> 5':listing.experience}} Years</span></h6>
                  <h6><b>Speaks:</b>
                    <span>
                      {{listing.professional.languages.join(', ').length>15?(listing.professional.languages.join(',
                      ')|slice:0:15)+' ...':listing.professional.languages.join(', ')}}
                    </span>
                  </h6>
                  <h6><b>Location:</b><span> {{listing.location.length>30?(listing.location|slice:0:30)+'
                      ...':listing.location}}</span></h6>
                </div>

                <hr class="style1" style="margin: 0;">

                <div style="min-height: 3rem;">
                  <span class="primary-cancel"
                    style="font-size: .8rem;font-weight: bold;letter-spacing:.7px">{{timezoneOffset==listing.timezoneOffset?'':'The
                    listing is in different timezone'}}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

    </div>
  </section>

</div>

<section *ngIf="listings?.length == 0" class="common-section business-section text-center" id="online_services"
  style="background-color:white">

  <div *ngIf="!listingsLoading" class="container" style="padding-top: 4rem;padding-bottom: 4rem;">
    <div class="col-xl-12 col-md-12">
      <div class="form-section">
        <img alt="GIF Image" src="assets/no_professional.gif" width="70%">
      </div>
    </div>
  </div>
  <div *ngIf="listingsLoading" class="container"
    style="padding-top: 4rem;padding-bottom: 4rem;min-height:20rem!important">
    <div class="col-xl-12 col-md-12">
      <div class="form-section">
        <i class="fas fa-spinner fa-pulse" style="font-size: xxx-large;"></i>
      </div>
    </div>
  </div>

</section>